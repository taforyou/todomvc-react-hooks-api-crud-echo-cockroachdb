(this["webpackJsonptodomvc-react-hooks-api-crud-echo-cockroachdb"]=this["webpackJsonptodomvc-react-hooks-api-crud-echo-cockroachdb"]||[]).push([[0],{24:function(e,t,r){e.exports=r(46)},46:function(e,t,r){"use strict";r.r(t);var n=r(0),a=r.n(n),o=r(22),c=r.n(o),l=r(23),i=r(6),u=r(5),s=r(7),d=r(2),p=r.n(d),m=r(8),f=r(9),h=r(11),g=r(10),b=r(12),v=r(4),E=r.n(v);function O(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function y(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?O(r,!0).forEach((function(t){Object(s.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):O(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var j="all",w="active",C="completed",k=function(e){function t(){var e,r;Object(m.a)(this,t);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return(r=Object(h.a)(this,(e=Object(g.a)(t)).call.apply(e,[this].concat(a)))).state={filter:j},r.getActiveTodos=function(){return r.props.todos.filter((function(e){return!e.completed}))},r.getCompletedTodos=function(){return r.props.todos.filter((function(e){return e.completed}))},r.getActiveCount=function(){return r.getActiveTodos().length},r.applyFilter=function(e){return r.setState({filter:e})},r.getFilteredTodos=function(){switch(r.state.filter){case w:return r.getActiveTodos();case C:return r.getCompletedTodos();case j:default:return r.props.todos}},r}return Object(b.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e=this.getFilteredTodos(),t=this.props,r=t.loading,n=t.error,o=t.modifyingTodos,c=t.errorTodos,l=t.retry,i=t.todos,u=this.props,s=u.create,d=u.update,p=u.remove,m=u.toggleAll,f=u.clearCompleted,h=this.getActiveCount(),g=this.props.todos.length-h,b=this.state.filter;return a.a.createElement(N,null,a.a.createElement(S,null,a.a.createElement("h1",null,"todos"),a.a.createElement(T,{loading:r,error:n,retry:l}),a.a.createElement(D,{onSubmit:s})),!i.length||a.a.createElement(a.a.Fragment,null,a.a.createElement(A,null,a.a.createElement(F,{modifyingTodos:o,errorTodos:c,todos:e,onUpdate:d,onRemove:p,toggleAll:m,hasActive:h>0})),a.a.createElement(P,null,a.a.createElement(U,{value:h}),a.a.createElement(B,{enabledFilter:b,applyFilter:this.applyFilter}),!g||a.a.createElement(K,{onClick:f}))))}}]),t}(a.a.Component),T=function(e){var t=e.loading,r=e.error,n=e.retry;return a.a.createElement("h5",{style:{position:"absolute",top:-48,right:10,color:r?"red":"inherit"}},!t||a.a.createElement(a.a.Fragment,null,"Loading..."),!r||a.a.createElement(a.a.Fragment,null,r," ",a.a.createElement("a",{href:"#",onClick:function(e){e.preventDefault(),n()}},"RETRY")))},N=function(e){var t=e.children;return a.a.createElement("section",{className:"todoapp"},t)},S=function(e){var t=e.children;return a.a.createElement("header",{className:"header"},t)},A=function(e){var t=e.children;return a.a.createElement("section",{className:"main"},t)},P=function(e){var t=e.children;return a.a.createElement("footer",{className:"footer"},t)},D=function(e){function t(){var e,r;Object(m.a)(this,t);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return(r=Object(h.a)(this,(e=Object(g.a)(t)).call.apply(e,[this].concat(a)))).state={title:""},r.handleChange=function(e){return r.setState({title:e.target.value})},r.handleSubmit=function(e){e.preventDefault(),r.state.title.length&&(r.props.onSubmit({title:r.state.title,completed:!1}),r.setState({title:""}))},r}return Object(b.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e=this.state.title;return a.a.createElement("form",{onSubmit:this.handleSubmit},a.a.createElement("input",{onChange:this.handleChange,value:e,className:"new-todo",placeholder:"What needs to be done?"}))}}]),t}(a.a.Component),F=function(e){var t=e.todos,r=e.onUpdate,n=e.onRemove,o=e.toggleAll,c=e.hasActive;return a.a.createElement(a.a.Fragment,null,a.a.createElement("input",{id:"toggle-all",className:"toggle-all",type:"checkbox",onChange:o,checked:!c}),a.a.createElement("label",{htmlFor:"toggle-all"},"Mark all as complete"),a.a.createElement("ul",{className:"todo-list"},t.sort((function(e,t){return e.id>t.id?1:-1})).map((function(e){return a.a.createElement(R,{key:"".concat(e.id,"::").concat(e.title),todo:e,onUpdate:r,onRemove:n})}))))},R=function(e){function t(){var e,r;Object(m.a)(this,t);for(var n=arguments.length,o=new Array(n),c=0;c<n;c++)o[c]=arguments[c];return(r=Object(h.a)(this,(e=Object(g.a)(t)).call.apply(e,[this].concat(o)))).state={editing:!1,submitting:!1,removing:!1,newTitle:""},r.ESCAPE_KEY=27,r.ENTER_KEY=13,r.inputRef=a.a.createRef(),r.startEditing=function(){r.setState({editing:!0,newTitle:r.props.todo.title},(function(){return r.inputRef.current.focus()}))},r.closeEditing=function(){return r.setState({editing:!1})},r.handleNewTitleChange=function(e){return r.setState({newTitle:e.target.value})},r.submitUpdate=function(){r.state.newTitle!==r.props.todo.title&&(r.setState({submitting:!0}),r.props.onUpdate(y({},r.props.todo,{title:r.state.newTitle})))},r.handleKeyDown=function(e){e.which===r.ESCAPE_KEY?(r.setState({newTitle:r.props.todo.title}),r.closeEditing()):e.which===r.ENTER_KEY&&r.submitUpdate(e)},r.remove=function(){r.setState({removing:!0}),r.props.onRemove(r.props.todo)},r.toggleCompleted=function(){return r.props.onUpdate(y({},r.props.todo,{completed:!r.props.todo.completed}))},r}return Object(b.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e=this.props.todo,t=e.title,r=e.completed,n=this.state,o=n.editing,c=n.submitting,l=n.removing,i=n.newTitle;return a.a.createElement("li",{className:E()({completed:r,editing:o}),style:{background:l?"#eee":null}},a.a.createElement("div",{className:"view"},a.a.createElement("input",{className:"toggle",type:"checkbox",checked:r,onChange:this.toggleCompleted}),a.a.createElement("label",{onDoubleClick:this.startEditing},t),a.a.createElement("button",{className:"destroy",onClick:this.remove})),a.a.createElement("input",{className:"edit",value:i,ref:this.inputRef,disabled:c,onChange:this.handleNewTitleChange,onBlur:this.submitUpdate,onKeyDown:this.handleKeyDown,autoFocus:!0}))}}]),t}(a.a.Component),U=function(e){var t=e.value;return a.a.createElement("span",{className:"todo-count"},a.a.createElement("strong",null,t)," item left")},B=function(e){var t=e.enabledFilter,r=e.applyFilter;return a.a.createElement("ul",{className:"filters"},a.a.createElement("li",null,a.a.createElement("a",{onClick:function(){return r(j)},className:E()({selected:t===j}),href:"#"},"All")),a.a.createElement("li",null,a.a.createElement("a",{onClick:function(){return r(w)},className:E()({selected:t===w}),href:"#"},"Active")),a.a.createElement("li",null,a.a.createElement("a",{onClick:function(){return r(C)},className:E()({selected:t===C}),href:"#"},"Completed")))},K=function(e){var t=e.onClick;return a.a.createElement("button",{className:"clear-completed",onClick:t},"Clear completed")},Y=k,_=r(3);function x(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var J=p.a.create({baseURL:"http://localhost:8080/api"});function L(e){var t=e.id,r=e.title,n=e.completed;return{url:"/todos/".concat(t||""),data:{title:r,completed:n}}}J.interceptors.request.use((function(e){return console.log(e),function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?x(r,!0).forEach((function(t){Object(s.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):x(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},e,{url:(Math.random()<0?"404":"")+e.url})})),Object(_.a)(J);var M=function(){var e=Object(_.b)("/todos"),t=Object(u.a)(e,3),r=t[0],o=void 0===r?[]:r,c=t[1],s=t[2],d=s.setData,p=Object(i.a)(s,["setData"]),m=Object(_.e)(L),f=Object(u.a)(m,3),h=f[0],g=f[1],b=f[2],v=b.data,E=Object(i.a)(b,["data"]);Object(n.useEffect)((function(){v&&d([].concat(Object(l.a)(o),[v]))}),[v]);var O=Object(_.d)(L),y=Object(u.a)(O,3),j=y[0],w=y[1],C=y[2],k=C.data,T=Object(i.a)(C,["data"]);Object(n.useEffect)((function(){d(o.map((function(e){return k.find((function(t){return t.id===e.id}))||e})))}),[k]);var N=Object(_.c)(L),S=Object(u.a)(N,3),A=S[0],P=S[1],D=S[2],F=D.succeed,R=Object(i.a)(D,["succeed"]);Object(n.useEffect)((function(){d(o.filter((function(e){return!F.includes(e)})))}),[F]);return a.a.createElement(Y,Object.assign({loading:c||g||w||P,todos:o,create:h,update:function(e){return j([e])},remove:function(e){return A([e])},toggleAll:function(){var e=Boolean(o.find((function(e){return!e.completed})));j(o.filter((function(t){return t.completed!==e})).map((function(t){return{id:t.id,completed:e}})))},clearCompleted:function(){return A(o.filter((function(e){return e.completed})))}},function(e,t,r,n){switch(!0){case Boolean(e.error):return{error:"fetch failed",retry:e.retry};case Boolean(t.error):return{error:"create failed",retry:t.retry};case Boolean(r.errors.length):return{error:"update failed",retry:r.retry};case Boolean(n.errors.length):return{error:"remove failed",retry:n.retry};default:return{}}}(p,E,T,R)))};c.a.render(a.a.createElement(M,null),document.getElementById("root"))}},[[24,1,2]]]);
//# sourceMappingURL=main.89f27693.chunk.js.map